language: go

go:
  - 1.14.x

install:
  - go get github.com/bostontrader/okcatbox
  - go run github.com/bostontrader/okcatbox &

script:
  - git clone https://github.com/bostontrader/okprobe
  - cd okprobe
  - go build

  # Test using an OKCatbox, not a real OKEx server
  - CATBOX_URL=http://localhost:8090
  - CATBOX_CREDENTIALS=okcatbox-read.json

  # funding
  - ./okprobe -url $CATBOX_URL -errors -keyfile $CATBOX_CREDENTIALS -endpnt currencies
  - ./okprobe -url $CATBOX_URL -errors -keyfile $CATBOX_CREDENTIALS -endpnt deposit-address
  - ./okprobe -url $CATBOX_URL -errors -keyfile $CATBOX_CREDENTIALS -endpnt deposit-history
  - ./okprobe -url $CATBOX_URL -errors -keyfile $CATBOX_CREDENTIALS -endpnt wallet
  - ./okprobe -url $CATBOX_URL -errors -keyfile $CATBOX_CREDENTIALS -endpnt withdrawal-fee

  # spot
  - ./okprobe -url $CATBOX_URL -keyfile $CATBOX_CREDENTIALS -errors -endpnt accounts

